#########################################
#  UCG Cart - Stage 3
#########################################

$CartButton off
$PatientButton off
$ProcedureButton off

$ECGCan on

$ContinenceSheet outline.on
$InjectionWater outline.on
$Antiseptic outline.on
$Lubricant outline.on
$Catheter outline.on
$UrineBag outline.on
$Gloves outline.on
$Syringe outline.on
$Tape outline.on
$CottonBalls outline.on

$ContinenceSheet clickable true
$InjectionWater clickable true
$Antiseptic clickable true
$Lubricant clickable true
$Catheter clickable true
$UrineBag clickable true
$Gloves clickable true
$Syringe clickable true
$Tape clickable true
$CottonBalls clickable true

$Patient clickable false
$Patient outline.off

label 'CartLoop'

	If
		$LeftHandButton pressed
	Then
		Prompt 'Left Hand is Active'
		Wait 1
		Prompt ''
		$LeftHandButton reset
		$ActiveHand = 'Left'
	Endif

	If
		$RightHandButton pressed
	Then
		Prompt 'Right Hand is Active'
		Wait 1
		Prompt ''
		$RightHandButton reset
		$ActiveHand = 'Right'
	Endif

	If
		$HandScrub pressed
	Then
		$HandScrub reset
		Do 'UCGTools/HandScrub.txt'
	Endif

	If
		$ContinenceSheet pressed
	Then
		$ContinenceSheet reset
		Do 'UCGTools/ContinenceSheet.txt'
	Endif

	If
		$InjectionWater pressed
	Then
		$InjectionWater reset
		Do 'UCGTools/InjectionWater.txt'
	Endif

	If
		$Antiseptic pressed
	Then
		$Antiseptic reset
		Do 'UCGTools/Antiseptic.txt'
	Endif

	If
		$Lubricant pressed
	Then
		$Lubricant reset
		Do 'UCGTools/Lubricant.txt'
	Endif

	If
		$Catheter pressed
	Then
		$Catheter reset
		Do 'UCGTools/OpenCatheter.txt'
	Endif

	If
		$CatheterBalloon pressed
	Then
		$CatheterBalloon reset		
		If
			$SyringeFull = true
		Then

			ZoomSpot Menu.Question 'Test Catheter balloon for leaks?'
			ZoomSpot Menu.Choices 'Yes','No'
			ZoomSpot Menu.on ZoomSpot
			WaitFor
				ZoomSpot Menu.Done
			Wait .1
			If
				ZoomSpot menu.result 'Yes'
			Then
				$TempCatheter = 'CatheterBalloon'

				Create $TempCatheter $TempCatheter
				$TempCatheter align $CatheterBalloon 0

				turnOff $CatheterBalloon

				$CatheterPort = $TempCatheter + '/Handle/Port'
				wait 1

				$TempCatheter localmovey .2 1
				wait 1
				$TempCatheter localmovez .08 1
				wait 1
				$TempCatheter localmovex .06 1
				wait 1
				$Syringe align $CatheterPort 1
				wait 1
				$Syringe localrotatex -90 .1
				wait .2
				$Syringe localmovey .06 .1
				wait .2
				$Plunger localmovey -.06 2
				turnOff $SyringeWater
				$TempCatheter play Grow true
				wait 4
				$Plunger localmovey .06 2
				wait 2
				turnOn $SyringeWater
				$TempCatheter play Grow false
				wait 2
				$TempCatheter moveto $CatheterPos 1
				wait .5
				turnOn $CatheterBalloon
				Destroy $TempCatheter
				$CatheterBalloon clickable false
				wait 1
				$Syringe moveto $CatheterPos
				wait 1
				Prompt 'No leaks found'
				wait 2
				Prompt ''

				turnOn $Stage4Button
			Endif
		Endif
	Endif

	If
		$UrineBag pressed
	Then
		$UrineBag reset
		Do 'UCGTools/AttachUrineBagBed.txt'
	Endif

	If
		$Gloves pressed
	Then
		$Gloves reset
		Do 'UCGTools/Gloves.txt'
	Endif

	If
		$Syringe pressed
	Then
		$Syringe reset
		Do 'UCGTools/Syringe.txt'
	Endif

	If
		$Tape pressed
	Then
		$Tape reset
		Do 'UCGTools/Tape.txt'
	Endif

	If
		$CottonBalls pressed
	Then
		$CottonBalls reset
		Do 'UCGTools/CottonBalls.txt'
	Endif

	If
		$BackECG pressed
	Then
		$BackECG reset
		Do 'UCGTools/ExitCart.txt'
		Return
	Endif

	wait .2
Goto 'CartLoop'