#/PatientCanvas off
JoystickCanvas on
$InfusionStand off
$Patient outline.on
$Vitalsmonitor outline.on
#Prompt 'Playerstart = ' + PlayerStart
Wait .51

wait .5

WipeCanvas off
/SyringeCanvas off
/IVCanvas off
/DripCanvas off

$Soap outline.on
$Gloves outline.on
$KidneyDish outline.on
$KidneyDish reset

$BloodBag outline.on
$Set outline.on
$PressureCuff outline.on
$Vitalsmonitor on
#$Patient outline.off
#$Vitalsmonitor outline.off

$Wipe1 outline.on
$Wipe1 reset
$Syringe outline.on
$Phone outline.on
$Phone clickable true

Do 'SummaryCheck.txt'


#Do 'InterventionLimit.txt'

$GlobalVar setglobal 'UsingTool' false

Label 'LoopN1'

	#$PatientCheckTotal =
	  #$GlobalVar getGlobal 'PatientCheckDone'

	#$Stage =
	  #$GlobalVar getGlobal 'Stage'

	$UsingTool =
	  $GlobalVar getGlobal 'UsingTool'

	If
		$SumButton pressed
	Then
		$SumButton reset
		$GlobalVar setglobal 'UsingTool' true
		$CheckCanvas off
		PatInfoCanvas off
		If
			$InterventionsCanvas isOn
		Then
			$UIMan closetoolinventory
		Endif
		Do 'SummaryCheck.txt'
		$GlobalVar setglobal 'UsingTool' false
	Endif

	If
		$PatientCheckTotal = 'True'
	Then
		wait 1    #wait for all GMs to finish up
		Do 'NEWS_Nurse/ChangeStage.txt'
	Endif

	If
		$EndGame isOnAndPressed
	Then
		#Do 'EndCheck.txt'
		If
			$BedNumber = 1
		Then
			ScoreTracker EndStage
		Endif

		Wait 1

		If
            $BedNumber = 1
        Then		
            ScoreTracker CloseStage
        Endif
        
        Wait 1  #needed for scorm
        SceneManager switchtoscene Scenes/MainMenu
	Endif

	If
		$PatientButton pressed
	Then
		$PatientButton reset
		Player align $PlayerStart 1
	Endif

	If
		$CartButton pressed
	Then
		$CartButton reset
		Player align $CartLook 1
	Endif

	If
		$ProcedureButton pressed
	Then
		$ProcedureButton reset
		Player align $UrinaryProcPos 1
	Endif


	If
		$CartObj pressed
	Then
		$CartObj reset
		$GlobalVar setglobal 'UsingTool' true
		$BackECG = 'ECGCheckCanvas/Choices/Exit'
		$ECGCan on
		Player align $CartLook .5
		turnOff $SumButton
		$CartObj clickable false

		Do 'NEWS_Nurse/Stage1/UCGCart.txt'
	Endif


	If
		$Curtain pressed
	Then
		$Curtain reset
		turnOff $Curtain
		turnOn $CurtainClosed
	Endif


	If
		$PatientSign pressed
	Then
		$PatientSign reset
		$GlobalVar setglobal 'UsingTool' true
		If
			$InterventionsCanvas isOn
		Then
			$UIMan closetoolinventory
		Endif
		Player align $LookAtPatientSign 1
		$ECGCan on
		label 'signLoop'
		If
			$BackECG pressed
		Then
			$BackECG reset
			$ECGCan off
			Player align $PlayerStart 1
			Wait .5
			$UseToolButton reset
			$GlobalVar setglobal 'UsingTool' false
			Goto 'LoopN1'
		Endif
		Goto 'signLoop'
	Endif

	If
		$Patient pressed
	Then
		$GlobalVar setglobal 'UsingTool' true
		$Patient reset
		$Patient outline.off
		JoystickCanvas off
#		ZoomSpot Menu.Question 'Which position you would like the patient in?'
		ZoomSpot Menu.Choices 'dorsal recumbent', 'knee chest position', 'Lithotomy' 
		ZoomSpot Menu.on ZoomSpot
		WaitFor
			ZoomSpot Menu.Done
		Wait .1
		If
			ZoomSpot menu.result 'dorsal recumbent'
		Then
			Prompt 'Positioning Patient'
			wait 1
			$Pillow = $Bed + '/pillow sofa'
			turnOff $Pillow
			$Patient play ExamPos true
			Prompt ''
		Else
			Prompt 'Incorrect position chosen'
			wait 2
			Prompt ''
		Endif
		$Patient outline.on
		JoystickCanvas on
		$GlobalVar setglobal 'UsingTool' false
		#Player align PlayerStart
	Endif

	#If
	#	$Wristband pressed
	#Then
	#	$Wristband reset
	#	Player align $BandView 1
	#	ZoomSpot Menu.Question 'Is this the correct patient?'
	#	ZoomSpot Menu.on ZoomSpot
	#	WaitFor
	#		ZoomSpot Menu.Done
	#	Wait .1
	#	If
	#		ZoomSpot menu.result $Yes
	#	Then
	#	######Eventually change so that it can be any patient and/or found by a tag not by name
	#		If
	#			$PatientName = 'Annie Lim'
	#		Then
	#			Prompt 'This is the correct patient'
	#			wait 3
	#			Prompt ''
	#			#SceneManager loadsceneadd Scene02Additive
	#			SceneManager switchtoscene Scenes/Scene02
	#			wait 3
	#			Return
	#		Else
	#			Prompt 'This is not the correct patient. Please find the correct patient.'
	#			wait 3
	#			Prompt ''
	#		Endif
	#	Endif
	#	Wait .1
	#	$Patient outline.on
	#	$Patient clickable true
	#
	#	Player align $PlayerStart 0.5
	#Endif

	If
		$Pat_Back pressed
	Then
		$Pat_Back reset
		PatInfoCanvas off
	Endif

	If
		$Vitalsmonitor pressed
	Then
		$Vitalsmonitor reset
		Do 'ToolTxt/AssessECG.txt'
	Endif

	If
		$Phone pressed
	Then
		$Phone reset
		Do 'NEWS_Nurse/Phone.txt'
	Endif

	If
		$Scene_Exit pressed
	Then 
		$Scene_Exit reset
		#ScoreTracker rangecomplete 0-14
		Do 'EndCheck.txt'
	Endif

	If
		$Check_End pressed
	Then
		$Check_End reset
		$CheckCanvas off
	Endif

	Wait .2
Goto 'LoopN1'
